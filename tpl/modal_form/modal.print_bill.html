<div>
    <div class="bg-light lter b-b wrapper-md">
        <span class="m-n h3"> Print Bill </span>
        <button class="close" type="button" ng-click="cancel()">
            <span aria-hidden="true">Ã—</span>
        </button>
    </div>

    <div ng-show ="enc.selected.finalize == '0'" id="bill_background">
        <p id="bg-text">DRAFT BILL</p>
    </div>

    <div class="wrapper-md">
        <div class="panel panel-info" draggable="true">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-sm-8">
                        <form name="myForm">
                            <input type="radio" ng-model="bill_type" value="bill_summary"> <b>Bill Summary</b> &nbsp;
                            <input type="radio" ng-model="bill_type" value="detailed_bill"> <b>Detailed Bill</b><br/>
                        </form>
                    </div>
                    <div class="col-sm-4">
                        <button ng-click="printBill()" class="btn btn-default pull-right"> 
                            <i class="fa fa-print"></i> Print Bill
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div ng-show="isShown('bill_summary')" id="bill_summary" ng-init="bill_summary = {}">
            <div class="bill-cont">
                <div class="bill-header"> 
                    <div id="logo"> 
                        <div class="date">Generated On : {{report_generated_date}}</div>
                    </div>
                    <div class="bill-heading"> <h1>BILL SUMMARY</h1> </div>
                    <div id="company">
                        <div id="invoice">
                            <div class="date">Generated By : {{report_generated_by}}</div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>

                <main>
                    <div class="clearfix" id="details">
                        <div id="patient-detail">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td colspan="2"><h2>Patient Detail:</h2></td>
                                </tr>
                                <tr>
                                    <td align="left" valign="top">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                            <tr ng-show="enc.selected.bill_no">
                                                <td><strong>Bill No</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.bill_no}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Name</strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.fullname}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Patient ID</strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.patient_global_int_code}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Age</strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.patient_age_ym}} / {{app.patientDetail.patientSex}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Encounter #</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.encounter_id}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Branch Name</strong></td>
                                                <td>:</td>
                                                <td>{{app.org_name}}</td>
                                            </tr>

                                        </table>
                                    </td>
                                    <td align="left" valign="top">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td><strong>Admission Date</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.encounter_date| moment:'DD/MM/YYYY - hh:mm A'}}</td>
                                            </tr>
                                            <tr ng-show="enc.selected.discharge_date">
                                                <td><strong>Discharge Date</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.discharge_date| moment:'DD/MM/YYYY - hh:mm A'}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Ward No</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.currentAdmission.room_details}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Stay Duration</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.stay_duration}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong><span id="ReportViewer_ReportViewer">Consultant Name</span></strong></td>
                                                <td>:</td>
                                                <td>
                                                    <span id="ReportViewer_ReportViewer2">
                                                        {{enc.selected.currentAdmission.consultant_name}}
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr ng-if="enc.selected.authorize == 0">
                                                <td><strong>Discharge Date</strong></td>
                                                <td>:</td>
                                                <td class="not_yet_discharge">NOT YET DISCHARGED</td>
                                                <!--                                                <td colspan="3" rowspan="2"> 
                                                                                                    <br>
                                                                                                    <h2 class="not_yet_discharge">NOT<br> DISCHARGED</h2>
                                                                                                </td>-->
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="clearfix"></div>

                    <table cellspacing="0" cellpadding="0" border="0" width="100%">
                        <thead>
                            <tr>
                                <th class="desc unit" colspan="2"><strong>Service</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="desc">Room Charges</td>
                                <td align="center">{{recurr_billing.total.recurring_total| number:2}}</td>
                            </tr>
                            <tr ng-if="procedures.length > 0">
                                <td class="desc">Procedures charges</td>
                                <td align="center">
                                    <span ng-repeat="(key, row) in procedures">
                                        <span ng-init="
                                                    row_total = getTotalExtra(row);
                                                    bill_summary.proce_total = bill_summary.proce_total + row_total;">    
                                        </span>
                                    </span>
                                    {{bill_summary.proce_total| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="consultants.length > 0">
                                <td class="desc">Professional charges</td>
                                <td align="center">
                                    <span ng-repeat="(key, row) in consultants">
                                        <span ng-init="
                                                    row_total = getTotalExtra(row);
                                                    bill_summary.profe_total = bill_summary.profe_total + row_total;">    
                                        </span>
                                    </span>
                                    {{bill_summary.profe_total| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="other_charges.length > 0">
                                <td class="desc">Other charges</td>
                                <td align="center">
                                    <span ng-repeat="(key, row) in other_charges">
                                        <span ng-init="
                                                    row_total = getTotalPrice(row);
                                                    bill_summary.others_total = bill_summary.others_total + row_total;">    
                                        </span>
                                    </span>
                                    {{bill_summary.others_total| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="pharmacy_charge.length > 0">
                                <td class="desc">Pharmacy charges</td>
                                <td align="center">
                                    <span ng-repeat="(key, row) in pharmacy_charge">
                                        <span ng-init="
                                                    row_total_balance = parseFloatIgnoreCommas(row.billings_total_balance_amount);
                                                    row_total_bill = parseFloatIgnoreCommas(row.bill_amount);
                                                    row_total_bill_paid = parseFloatIgnoreCommas(row.billings_total_paid_amount_using_pharmacy);
                                                    bill_summary.pharmacy_balance = bill_summary.pharmacy_balance + row_total_balance;
                                                    bill_summary.pharmacy_bill = bill_summary.pharmacy_bill + row_total_bill;
                                                    bill_summary.pharmacy_paid = bill_summary.pharmacy_paid + row_total_bill_paid;">    
                                        </span>
                                    </span>
                                    {{bill_summary.pharmacy_bill| number:2}}
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td>&nbsp;</td>
                                <td class="bb" align="center">&nbsp;</td>
                            </tr>
                            <tr>
                                <td>GRAND TOTAL :</td>
                                <td align="center">
                                    {{(billing.total.charge + billing.total.extra + recurr_billing.total.recurring_total + bill_summary.pharmacy_bill) | number:2}}
                                </td>
                            </tr>
                            <tr>
                                <td>Paid Amount :</td>
                                <td align="center">
                                    <span ng-hide="true">{{billing_total_paid = billing.total.advance_charge + bill_summary.pharmacy_paid}}</span> 
                                    <span>{{billing_total_paid ||'0' | number:2}}</span>
                                </td>
                            </tr>
                            <!--                            <tr>
                                                            <td>Room Discount :</td>
                                                            <td align="center">
                                                                {{enc.selected.concession_amount| number:2}}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Other Discount :</td>
                                                            <td align="center">
                                                                {{billing.total.concession|| "0" | number:2}}
                                                            </td>
                                                        </tr>-->
                            <tr ng-if="billing.discount > 0">
                                <td>Discount :</td>
                                <td align="center">
                                    {{billing.discount | number:2}}
                                </td>
                            </tr>
                            <tr>
                                <td>NET TOTAL :</td>
                                <td align="center">{{(billing.total.price + recurr_billing.total.recurring_total + bill_summary.pharmacy_bill) - billing_total_paid - enc.selected.concession_amount - recurr_billing.total_pharmacy.recurring_total_concession | number:2}}</td>
                            </tr>
                        </tfoot>
                    </table>

                    <!--                    <div id="notices">
                                            <div></div>
                                            <div class="notice">
                                                <span id="ReportViewer_ReportViewer3">
                                                    {{app.org_address}}
                                                    {{app.org_city}} 
                                                    {{app.org_state}} 
                                                    {{app.org_country}}. 
                                                    Ph :{{app.org_mobile}}
                                                </span>
                                            </div>
                                        </div>-->
                </main>
            </div>
        </div>

        <div ng-show="isShown('detailed_bill')" id="detailed_bill" ng-init="detailed_billing.total = {}">
            <div class="bill-cont">
                <div class="bill-header"> 
                    <div id="logo"> 
                        <div class="date">Generated On : {{report_generated_date}}</div>
                    </div>
                    <div class="bill-heading"> <h1>DETAILED BILL</h1> </div>
                    <div id="company">
                        <div id="invoice">
                            <div class="date">Generated By : {{report_generated_by}}</div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>

                <main>
                    <div class="clearfix" id="details">
                        <div id="patient-detail">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td colspan="2"> <h2>Patient Detail:</h2></td>
                                </tr>
                                <tr>
                                    <td align="left" valign="top">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                            <tr ng-show="enc.selected.bill_no">
                                                <td><strong>Bill No</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.bill_no}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Name</span></strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.fullname}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Patient ID</span></strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.patient_global_int_code}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Age</strong></td>
                                                <td>:</td>
                                                <td>{{patientObj.patient_age_ym}} / {{app.patientDetail.patientSex}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Encounter #</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.encounter_id}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Branch Name</strong></td>
                                                <td>:</td>
                                                <td>{{app.org_name}}</td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td align="left" valign="top">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td><strong>Admission Date</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.encounter_date| moment:'DD/MM/YYYY - hh:mm A'}}</td>
                                            </tr>
                                            <tr ng-show="enc.selected.discharge_date">
                                                <td><strong>Discharge Date</span></strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.discharge_date| moment:'DD/MM/YYYY - hh:mm A'}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Ward No</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.currentAdmission.room_details}}</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Stay Duration</strong></td>
                                                <td>:</td>
                                                <td>{{enc.selected.stay_duration}}</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <strong>
                                                        <span id="ReportViewer_ReportViewer">
                                                            Consultant Name
                                                        </span>
                                                    </strong>
                                                </td>
                                                <td>:</td>
                                                <td>
                                                    <span id="ReportViewer_ReportViewer2">
                                                        {{enc.selected.currentAdmission.consultant_name}}
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr ng-if="enc.selected.authorize == 0">
                                                <td><strong>Discharge Date</strong></td>
                                                <td>:</td>
                                                <td class="not_yet_discharge">NOT YET DISCHARGED</td>
                                                <!--                                                <td colspan="3" rowspan="2"> 
                                                                                                    <br>
                                                                                                    <h2 class="not_yet_discharge">NOT<br> DISCHARGED</h2>
                                                                                                </td>-->
                                            </tr>

                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="clearfix"></div>

                    <table cellspacing="0" cellpadding="0" border="0" ng-init="detailed_recurr_billing.total =  {}; detailed_non_billing.total =  {};">
                        <thead>
                            <tr>
                                <th class="unit"><strong>Date</strong></th>
                                <th class="unit"><strong>DESCRIPTION </strong></th>
                                <th class="unit"><strong>Debit</strong></th>
                                <th class="unit"><strong>Credit</strong></th>
                                <th class="unit"><strong>Net TOTAL</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!----Recurring Charges--->
                            <tr>
                                <td colspan="5">
                                    <h3> Room Charge: </h3> 
                                </td>
                            </tr>
                            <tr ng-repeat="(key, row) in recurring_charges">
                                <td>
                                    <span id="ReportViewer_ReportViewer3">{{row.to_date| moment:'DD-MMM-YYYY'}}</span>
                                </td>
                                <td>
                                    {{row.charge_item}} ({{row.charge_amount}} * {{row.duration}}) ({{row.room_type}}) ({{row.tenant_name}})
                                </td>
                                <td align="center" ng-init="
                                            row_recurring_total = getTotalRecurringPrice(row);
                                            detailed_recurr_billing.total.recurring_total = detailed_recurr_billing.total.recurring_total + row_recurring_total;
                                    "> {{row_recurring_total| number:2}}</td>
                                <td class="qty">&nbsp;</td>
                                <td align="center">
                                    {{row.net_amount| number:2}}
                                </td>
                            </tr>
                            <tr class="bn">
                                <td colspan="2">&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{detailed_recurr_billing.total.recurring_total| number:2}}</strong>
                                </td>
                                <td class="qty">&nbsp;</td>
                                <td>
                                    &nbsp;
                                </td>
                            </tr>

                            <!----Procedure charges--->
                            <tr ng-if="procedures != ''">
                                <td colspan="5">
                                    <h3> Procedure Charges:</h3>
                                </td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_1_total = detailed_recurr_billing.total.recurring_total" ng-repeat="(key, row) in procedures">
                                <td>{{row.date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.headers}} ({{row.tenant_name}})</td>
                                <td align="center" ng-init="
                                            row_total = getTotalExtra(row);
                                            detailed_non_billing.total.charge = detailed_non_billing.total.charge + row_total;
                                            detailed_billing.total.procedure_total = detailed_billing.total.procedure_total + row_total;
                                            detailed_billing.total.procedure_net_total = detailed_recurr_billing.total.recurring_total + parseFloat(row.net_amount);
                                    ">{{row_total| number:2}}</td>
                                <td class="qty">&nbsp;</td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_1_total + row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="procedures != ''">
                                <td colspan="2">&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{(detailed_billing.total.procedure_total)| number:2}}</strong>
                                </td>
                                <td colspan="2">&nbsp;</td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.procedure_net_total">
                                <td colspan="5" ng-init="detailed_billing.total.procedure_net_total = detailed_recurr_billing.total.recurring_total"></td>
                            </tr>

                            <!----Professional charges--->
                            <tr ng-if="consultants != ''">
                                <td colspan="5">
                                    <h3> Professional Charges:</h3>
                                </td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_2_total = detailed_billing.total.procedure_net_total;" ng-repeat="(key, row) in consultants">
                                <td>{{row.date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.headers}} ({{row.tenant_name}})</td>
                                <td align="center" ng-init="
                                            row_total = getTotalExtra(row);
                                            detailed_non_billing.total.charge = detailed_non_billing.total.charge + row_total;
                                            detailed_billing.total.consultant_total = detailed_billing.total.consultant_total + row_total;
                                            detailed_billing.total.consultant_net_total = detailed_billing.total.procedure_net_total + parseFloat(row.net_amount);
                                    ">{{row_total| number:2}}</td>
                                <td class="qty">&nbsp;</td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_2_total + row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="consultants != ''">
                                <td colspan="2">&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{(detailed_billing.total.consultant_total)| number:2}}</strong>
                                </td>
                                <td colspan="2">&nbsp;</td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.consultant_net_total">
                                <td colspan="5" ng-init="detailed_billing.total.consultant_net_total = detailed_billing.total.procedure_net_total"></td>
                            </tr>

                            <!----other charges--->                            
                            <tr ng-if="other_charges.length > 0 && other_charges.length != ''">
                                <td colspan="5"><h3> Other Charges:</h3></td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_3_total = detailed_billing.total.consultant_net_total" ng-repeat="(key, row) in other_charges">
                                <td>{{row.date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.category}}({{row.headers}}) ({{row.tenant_name}})</td>
                                <td align="center" ng-init="
                                            row_total = getTotalPrice(row);
                                            detailed_non_billing.total.charge = detailed_non_billing.total.charge + row_total;
                                            detailed_billing.total.other_total = detailed_billing.total.other_total + row_total;
                                            detailed_billing.total.other_net_total = detailed_billing.total.consultant_net_total + parseFloat(row.net_amount);
                                    ">{{row_total| number:2}}</td>
                                <td class="qty">&nbsp;</td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_3_total + row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="other_charges.length > 0 && other_charges.length != ''">
                                <td colspan="2">&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{(detailed_billing.total.other_total)| number:2}}</strong>
                                </td>
                                <td colspan="2">&nbsp;</td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.other_net_total">
                                <td colspan="5" ng-init="detailed_billing.total.other_net_total = detailed_billing.total.consultant_net_total"></td>
                            </tr>

                            <!----Pharmacy charges--->                            
                            <tr ng-if="pharmacy_charge.length > 0 && pharmacy_charge.length != ''">
                                <td colspan="5"><h3> Pharmacy Charges:</h3></td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_41_total = detailed_billing.total.other_net_total" ng-repeat="(key, row) in pharmacy_charge">
                                <td>{{row.sale_date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.bill_no}}<span ng-if="row.tenant_id != logged_tenant_id"> ({{row.branch_name}}) </span></td>
                                <td align="center" ng-init="
                                            row_total = parseFloatIgnoreCommas(row.bill_amount);
                                            detailed_non_billing.total.charge = detailed_non_billing.total.charge + row_total;
                                            detailed_billing.total.pharmacy_total = detailed_billing.total.pharmacy_total + row_total;
                                            detailed_billing.total.pharmacy_net_total = detailed_billing.total.other_net_total + parseFloat(row.net_amount);
                                    ">{{row_total| number:2}}</td>
                                <td class="qty">&nbsp;</td>
                                <td align="center">
                                    {{detailed_billing.total.net_step_41_total + row.net_amount| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="pharmacy_charge.length > 0 && pharmacy_charge.length != ''">
                                <td colspan="2">&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{(detailed_billing.total.pharmacy_total)| number:2}}</strong>
                                </td>
                                <td colspan="2">&nbsp;</td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.pharmacy_net_total">
                                <td colspan="5" ng-init="detailed_billing.total.pharmacy_net_total = detailed_billing.total.other_net_total"></td>
                            </tr>

                            <!----Advance--->
                            <tr ng-if="((advances.length > 0 && advances.length != '') || (pharmacy_bill.length > 0 && pharmacy_bill.length != ''))">
                                <th class="unit"><strong>Date</strong></th>
                                <th class="unit"><strong>DESCRIPTION </strong></th>
                                <th class="unit"><strong>Debit</strong></th>
                                <th class="unit"><strong>Credit</strong></th>
                                <th class="unit"><strong>Net TOTAL</strong></th>
                            </tr>
                            <!-- Pharmacy bill -->
                            <tr ng-if="pharmacy_bill.length > 0 && pharmacy_bill.length != ''">
                                <td colspan="5"><h3> Pharmacy Bill: </h3></td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_42_total = detailed_billing.total.pharmacy_net_total" ng-repeat="(key, row) in pharmacy_bill">
                                <td>{{row.paid_date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.bill_no}}<span ng-if="row.sale_return_bill_no"> (Sale Return Bill No [{{row.sale_return_bill_no}}]) </span></td>
                                <td>&nbsp;</td>
                                <td align="center" ng-init="
                                            detailed_non_billing.total.pharmacy_adv_charge = detailed_non_billing.total.pharmacy_adv_charge + parseFloatIgnoreCommas(row.sale_details.billings_total_paid_amount_using_pharmacy);
                                            detailed_billing.total.pharmacy_bill_net_total = detailed_billing.total.pharmacy_net_total - parseFloat(row.net_amount);
                                    ">{{row.sale_details.billings_total_paid_amount_using_pharmacy| number:2}}</td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_42_total - row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr class="bn" ng-if="pharmacy_bill.length > 0 && pharmacy_bill.length != ''">
                                <td>&nbsp;</td>
                                <td align="right">&nbsp;</td>
                                <td>&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{detailed_non_billing.total.pharmacy_adv_charge| number:2}}</strong></td>
                                <td></td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.pharmacy_bill_net_total" class="hide">
                                <td colspan="5" ng-init="detailed_billing.total.pharmacy_bill_net_total = detailed_billing.total.pharmacy_net_total"></td>
                            </tr>
                            
                            <!--Advance -->
                            <tr ng-if="advances.length > 0 && advances.length != ''">
                                <td colspan="5"><h3> Advance: </h3></td>
                            </tr>
                            <tr ng-init="detailed_billing.total.net_step_4_total = detailed_billing.total.pharmacy_bill_net_total" ng-repeat="(key, row) in advances">
                                <td>{{row.payment_date| moment:'DD-MMM-YYYY'}}</td>
                                <td>{{row.headers}} ({{row.tenant_name}})</td>
                                <td>&nbsp;</td>
                                <td align="center" ng-init="
                                            detailed_non_billing.total.adv_charge = detailed_non_billing.total.adv_charge + parseFloat(row.total_charge);
                                            detailed_billing.total.advance_net_total = detailed_billing.total.pharmacy_bill_net_total - parseFloat(row.net_amount);
                                    ">{{row.total_charge| number:2}}</td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_4_total - row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr class="bn" ng-if="advances.length > 0 && advances.length != ''">
                                <td>&nbsp;</td>
                                <td align="right">&nbsp;</td>
                                <td>&nbsp;</td>
                                <td align="center" class="bb">
                                    <strong>{{detailed_non_billing.total.adv_charge| number:2}}</strong></td>
                                <td></td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.advance_net_total" class="hide">
                                <td colspan="5" ng-init="detailed_billing.total.advance_net_total = detailed_billing.total.pharmacy_bill_net_total"></td>
                            </tr>
                            
                            <!-- Discount -->
                            <tr ng-if="billing.discount > 0">
                                <td colspan="5"><h3> Discount </h3></td>
                            </tr>
                            
                            <!-- Pharmacy Discount Start-->
                            <tr ng-init="detailed_billing.total.net_step_51_total = detailed_billing.total.advance_net_total" ng-repeat="(key, row) in pharmacy_concession">
                                <td>{{row.paid_date| moment:'DD-MMM-YYYY'}}</td>
                                <td>Bill No > {{row.bill_no}}</td>
                                <td align="center">&nbsp;</td>
                                <td ng-init="detailed_billing.total.pharmacy_concession_net_total = detailed_billing.total.advance_net_total - parseFloat(row.net_amount)">
                                    {{row.paid_amount| number:2}}
                                </td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_51_total - row.net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.pharmacy_concession_net_total" class="hide">
                                <td colspan="5" ng-init="detailed_billing.total.pharmacy_concession_net_total = detailed_billing.total.advance_net_total"></td>
                            </tr>
                            <!-- Pharmacy Discount End-->
                            
                            <!-- Procedure Discount Start-->
                            <tr ng-init="detailed_billing.total.net_step_5_total = detailed_billing.total.pharmacy_concession_net_total" ng-repeat="(key, row) in procedures | filter:greaterThan('concession_amount', 0.00)">
                                <td>{{row.date| moment:'DD-MMM-YYYY'}}</td>
                                <td>Procedure > {{row.headers}}</td>
                                <td align="center">&nbsp;</td>
                                <td ng-init="detailed_billing.total.proc_concession_net_total = detailed_billing.total.advance_net_total - parseFloat(row.concession_net_amount)">
                                    {{row.concession_amount| number:2}}
                                </td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_5_total - row.concession_net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.proc_concession_net_total" class="hide">
                                <td colspan="5" ng-init="detailed_billing.total.proc_concession_net_total = detailed_billing.total.pharmacy_concession_net_total"></td>
                            </tr>
                            <!-- Procedure Discount End-->
                            
                            <!-- Professional Discount Start -->
                            <tr ng-init="detailed_billing.total.net_step_6_total = detailed_billing.total.proc_concession_net_total" ng-repeat="(key, row) in consultants | filter:greaterThan('concession_amount', 0.00)">
                                <td>{{row.date| moment:'DD-MMM-YYYY'}}</td>
                                <td>Professionals > {{row.headers}}</td>
                                <td align="center">&nbsp;</td>
                                <td ng-init="detailed_billing.total.profe_concession_net_total = detailed_billing.total.proc_concession_net_total - parseFloat(row.concession_net_amount)">
                                    {{row.concession_amount| number:2}}
                                </td>
                                <td align="center">
                                    {{(detailed_billing.total.net_step_6_total - row.concession_net_amount)| number:2}}
                                </td>
                            </tr>
                            <tr ng-if="!detailed_billing.total.profe_concession_net_total" class="hide">
                                <td colspan="5" ng-init="detailed_billing.total.profe_concession_net_total = detailed_billing.total.proc_concession_net_total"></td>
                            </tr>
                            <!-- Professional Discount End -->
                            
                            <!-- Room Discount Start-->
                            <tr ng-if="enc.selected.concession_amount != '0.00'">
                                <td>&nbsp;</td>
                                <td>Room Discount</td>
                                <td>&nbsp;</td>
                                <td>
                                    {{enc.selected.concession_amount}}
                                </td>
                                <td align="center">
                                    {{(detailed_billing.total.profe_concession_net_total - enc.selected.concession_amount)| number:2}}
                                </td>
                            </tr>
                            <!-- Room Discount End-->

                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="5">&nbsp;</td>
                            </tr>
                            <tr>
                                <td colspan="4">GRAND TOTAL :</td>
                                <td align="center">{{(billing.total.charge + billing.total.extra + recurr_billing.total.recurring_total + detailed_billing.total.pharmacy_total) | number:2}}</td>
                            </tr>
                            <tr>
                                <td colspan="4">PAID AMOUNT :</td>
                                <td align="center">{{(billing.total.advance_charge + detailed_non_billing.total.pharmacy_adv_charge) | number:2}}</td>
                            </tr>
                            <tr>
                                <td colspan="4">Discount :</td>
                                <td align="center">{{billing.total.other_discount + parseFloat(enc.selected.concession_amount) | number:2}}</td>
                                <!--<td align="center">{{recurr_billing.total_pharmacy.recurring_total_concession}}</td> -->
                            </tr>
                            <tr>
                                <td colspan="4">NET TOTAL :</td>
                                <td align="center">
                                    {{(billing.total.price + recurr_billing.total.recurring_total + detailed_billing.total.pharmacy_total) - billing.total.advance_charge - enc.selected.concession_amount - detailed_non_billing.total.pharmacy_adv_charge - recurr_billing.total_pharmacy.recurring_total_concession | number:2}}
                                </td>
                            </tr>
                            <!--                            <tr>
                                                            <td colspan="4">ADVANCE :</td>
                                                            <td align="center">
                                                                <span ng-if="billing.total.advance_charge">{{billing.total.advance_charge| number:2}} </span>	
                                                                <span ng-if="!billing.total.advance_charge"> 0.00 </span>	
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="4">Room Discount :</td>
                                                            <td align="center">
                                                                {{enc.selected.concession_amount| number:2}}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="4">Other Discount :</td>
                                                            <td align="center">
                                                                {{billing.total.concession|| "0" | number:2}}
                                                            </td>
                                                        </tr>-->

                        </tfoot>
                    </table>
                </main>
            </div>
        </div>
    </div>
</div>